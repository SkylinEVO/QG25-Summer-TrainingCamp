在过去三周的学习中，我了解到了许多新知识，也回顾了以前做的不够好的方面，下面我将简单的汇总一下这个阶段的学习情况以及未来的展望。

## 一、学习记录：从“零散点”到“结构化”

### 1.阶段学习：搭建知识体系

在暑期训练营的前两个星期内，我沿着既定的学习路线逐个击破各个知识点，围绕实战例子巩固知识点，为后续的项目开发打下坚实基础。

* **基础巩固**：训练营初期先和团队的其他成员一起温习了Git的相关知识，掌握基础的Git指令，学会解决冲突；其次是学习Android移动开发的“筑基石”——Kotlin，由于之前学习Android移动开发使用的是Java，因此在学习Kotlin途中也没有太大的问题，Lambda表达式等新知识还需加强巩固；接着还有单例模式加上观察者模式。
* **框架深入**：通过CSDN博客、B站和其他论坛系统学习了Jetpack组件（ViewModel、LiveData、Room），理解了“数据驱动UI”的设计思想；同时也掌握了Retrofit网络库的基本用法，以及Gson解析的实用技巧。
* **知识升阶**：掌握MVP架构并了解MVVM架构模式，学会用dataBinding简化UI与数据库的绑定；了解了Glide加载图片的缓存机制；学习了使用Material Design美化UI界面，并写了一个最佳实践。

### 2.学习方法：由”被动输入“转为”主动输出“

* 在学习不同板块的知识时，都通过写demo的方式巩固知识点，灵活运用解决实际问题，将知识体系具象化。当demo数量足够多时便会由量变引起质变，从能读懂变成能运用。
* 回看上一阶段的学习经历和项目，寻找利用当前阶段学习的知识进行优化的可能性。例如以前做的项目用的只是fragment和tablayout，整个页面的切换会显得比较单薄空洞，而使用了Material Design的NavigationView之后可以让原来的UI变得更加丝滑，显得更加智能。
* 及时记录，学习每个板块的知识都写一份Markdown笔记，有可能的话用流程图或思维导图梳理清楚逻辑，在笔记中加入具体的代码块方便后续回看复习时更好地理解消化。

## 二、项目实战：在踩坑中实践知识

### 1.项目背景和目标：

我负责开发的时一个能和嵌入式”智能底座“数据互传的喝水记录app模块，核心功能包括添加每日喝水记录、获得底座传到手机的喝水记录、数据本地存储（用Room数据库）、生成可视化的喝水记录并实现保存分享。目标是将学习到的Material Design、数据持久化、UI控件和Mqtt协议传输等知识整合起来，做出一个能实际运行的小应用。

### 2.开发过程：从“理论可行”到“实践开始”

* **前期设计**：先设计好打开App之后的主体UI框架，确定Toolbar、滑动菜单、详情页、添加页等跳转逻辑；再确定不同板块（UI、数据处理、Room）的设计。
* **前置学习**：这个项目是和嵌入式一起开发的，要用到Mqtt协议传输数据，我通过CSDN博客和EMQX社区学习了如何使用Mqtt协议传输。
* **核心功能实现**：
  - **数据库部分**：由于每次切换fragment都调用onResume()方法刷新页面，若不设计持久化技术则会导致数据流失。因此选择使用Room定义Water实体类和Dao接口，通过@Insert、@Query、@Delete注解实现增删改查，保证每一天的记录都会被记录进数据库且不会重复录入。
  - **UI交互**：使用RecyclerView展示喝水记录，接收到底座传回来的喝水记录就自动插入记录。由于喝水记录的设计理念是每日仅能设置一次目标，但可以多次修改目标，因此要正确设计各个按钮是否能够被按下的逻辑。
  - **细节优化**：用圆形进度图直观显示已喝水量和目标的占比、添加了“查看昨日记录”的功能、达成目标的庆祝动画、用Toast提示输入出错等细节，提升用户体验。

### 3.踩坑与解决方案

* **Mqtt请求断连**：一开始没有在有关Mqtt协议传输的方法里添加判断断连与重连的逻辑导致切换Fragment之后无法收发消息。
* **Toolbar点击事件的注册**：一开始我将Toolbar的点击事件写在Fragment里的onOptionsItemSelected()方法里，导致后面不同模块代码合并时点击按钮没有响应，之后将代码迁移至MainActivity里后点击事件可以被监听到。

```kotlin
override fun onOptionsItemSelected(item: MenuItem): Boolean {
    when (item.itemId) {
        android.R.id.home -> drawerLayout.openDrawer(GravityCompat.START)
        R.id.focus_add -> showAddDialog()
        R.id.focus_sum -> {
            val intent = Intent(this, SummaryActivity::class.java)
            startActivity(intent)
        }
        R.id.waterShare -> {
            // 处理WaterFragment的分享按钮
            ...
        R.id.history -> {
            // 处理WaterFragment的历史按钮
            ...
}
```

* **MqttHelper实例的定义位置不对**：一开始我在Fragment里面定义了MqttHelper实例，但发现最后在代码合并之后，当我切换到别的Fragment之后再发送喝水记录之后就收不到消息了，因此我把所有有关喝水的Mqtt协议传输的方法都移动到MainActivity里

```kotlin
// 添加访问器方法供MainActivity使用
fun getAdapter(): WaterAdapter = adapter
fun getBinding() = binding
fun getCurrentGap(): Int = currentGap
```

## 三、阶段总结与未来展望

这段“学习+开发”的经历让我深刻地体会到了理论只是“地基”，只有在demo、项目实战中用起来才能真正理解知识的价值。从一开始对着项目文档的迷茫到最后看到精美的App，收获的不只是成功的喜悦，还有“遇到问题→拆分问题→解决问题”的思维方式。

接下来我将继续学习MVVM架构的知识和WebSockect的相关知识，准备迎接下一阶段的项目开发。

如果你也在学习Android移动开发，不妨也试试 “围绕项目补知识” 的方法一起努力，毕竟 ~~程序和代码有一个能跑就行~~ 代码写出来能在手机上启动才是最有成就感的事情。